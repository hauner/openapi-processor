<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>using Spring Pageable &amp; Page :: openapi-processor</title>
    <link rel="canonical" href="https://hauner.github.io/openapi-processor/spring/howto/pageable-page-mapping.html">
    <meta name="generator" content="Antora 2.3.0-beta.2">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <img src="../../../_/img/openapi-processor-p.svg" alt="logo" width="100px">
      <a class="navbar-item" href="https://hauner.github.io/openapi-processor">openapi-processor</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

            <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-spring">
              <img src="../../../_/img/GitHub-Mark-32px.png" alt="GitHub"> spring
            </a>
            <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-json">
              <img src="../../../_/img/GitHub-Mark-32px.png" alt="GitHub"> json
            </a>
            <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-gradle">
              <img src="../../../_/img/GitHub-Mark-32px.png" alt="GitHub"> gradle
            </a>

      </div>

    </div>

  </nav>
</header>

<div class="body">
<div class="nav-container" data-component="spring" data-version="1.0.0.M14">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">oap-spring</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../processor/index.html">The Processor</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../processor/configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../processor/endpoint-interface.html">Endpoint Grouping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../processor/endpoint-content.html">Endpoint Content Type</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../processor/models.html">Models</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../processor/parameter.html">Parameter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../processor/requestbody.html">Request Body</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../processor/response.html">Responses</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../processor/identifier.html">Identifier</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../mapping/index.html">Type Mapping</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/structure.html">Type Mapping Structure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/basic.html">Default Type Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/global.html">Global Type Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/parameter.html">Global Parameter Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/response.html">Global Response Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/result.html">Global Result Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/single.html">Global Single Result Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/endpoint.html">Endpoint Mapping</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../gradle.html">Gradle Integration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">HowTo</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Mapping</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="global-array-mapping.html">Global Array Mapping</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="pageable-page-mapping.html">Pageable &amp; Page Mapping</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">OpenAPI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="file_upload.html">File Upload</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="file_download.html">File Download</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../links.html">Links</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">oap-spring</span>
    <span class="version">1.0.0.M14</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">oap-api</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../api/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">oap-gradle</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../gradle/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">oap-json</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../json/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">oap-spring</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../index.html">master</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">1.0.0.M14</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">oap-spring-mvc-sample</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../spring-mvc-sample/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">oap-spring-webflux-sample</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../spring-webflux-sample/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
  <div class="edit-this-page"><a href="https://github.com/hauner/openapi-processor-spring/blob/v1.0.0.M14/docs/modules/ROOT/pages/howto/pageable-page-mapping.adoc">edit</a></div>
    <div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">1.0.0.M14</button>
  <div class="version-menu">
    <a class="version" href="../../howto/pageable-page-mapping.html">master</a>
    <a class="version is-current" href="pageable-page-mapping.html">1.0.0.M14</a>
  </div>
</div>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">oap-spring</a></li>
    <li><a href="index.html">HowTo</a></li>
    <li>Mapping</li>
    <li><a href="pageable-page-mapping.html">Pageable &amp; Page Mapping</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">using Spring Pageable &amp; Page</h1>
<div class="paragraph">
<p>The given (lengthy) openapi yaml example describes a pageable api in two variations. The <code>/page</code>
endpoint uses named objects, and the second endpoint <code>/page-inline</code> uses inline objects to describe
the paging parameters and the page response. We fill focus on the first variation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">openapi: 3.0.2
info:
  title: Spring Page/Pageable API
  version: 1.0.0

paths:
  /page:
    get:
      parameters:
        - in: query <i class="conum" data-value="1"></i><b>(1)</b>
          name: pageable
          required: false
          schema:
            $ref: '#/components/schemas/Pageable'
      responses:
        '200':
          description: none
          content: <i class="conum" data-value="2"></i><b>(2)</b>
            application/json:
              schema:
                $ref: '#/components/schemas/StringPage'

  /page-inline:
    get:
      parameters:
        - in: query <i class="conum" data-value="3"></i><b>(3)</b>
          name: pageable
          required: false
          schema:
            type: object
            properties:
              page:
                type: integer
              size:
                type: integer
      responses:
        '200':
          description: none
          content:
            application/json:
              schema: <i class="conum" data-value="4"></i><b>(4)</b>
                type: object
                allOf:
                  - $ref: '#/components/schemas/Page'
                  - $ref: '#/components/schemas/StringContent'

components:
  schemas:

    Pageable: <i class="conum" data-value="5"></i><b>(5)</b>
      description: minimal Pageable query parameters
      type: object
      properties:
        page:
          type: integer
        size:
          type: integer

    Page: <i class="conum" data-value="6"></i><b>(6)</b>
      description: minimal Page response without content property
      type: object
      properties:
        number:
          type: integer
        size:
          type: integer

    StringContent: <i class="conum" data-value="7"></i><b>(7)</b>
      description: specific content List of the Page response
      type: object
      properties:
        content:
          type: array
          items:
            type: string

    StringPage: <i class="conum" data-value="8"></i><b>(8)</b>
      description: typed Page
      type: object
      allOf:
        - $ref: '#/components/schemas/Page'
        - $ref: '#/components/schemas/StringContent'</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Describing the <code>Pageable</code> query parameters <code>page</code>, <code>size</code> etc in OpenAPI as an <code>object</code> lets us
group the parameters. That tells a reader of the api that they belong together, and we can avoid
confusion when there are more query parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Describing the <code>Page</code> result is a bit more complicated. OpenAPI does not have generic types
which we would like to have to define what type is in the content list of the page.
<div class="paragraph">
<p>The best OpenAPI way is to define two objects. The first one describes the common properties of the
<code>Page</code> response, and the second one the content list of the page. In this example the <code>StringContent</code>
with an array of <code>string</code>.</p>
</div>
<div class="paragraph">
<p>Using OpenAPIs <code>allOf</code> construct we join both objects to describe a complete response that
corresponds to a Spring <code>Page</code> object.</p>
</div>
<div class="paragraph">
<p>Splitting the <code>Page</code> object is useful too if we have multiple endpoints with paging because we do
not have to repeat the common properties for every endpoint.</p>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Inline <code>Pageable</code> definition.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Partial inline definition of the <code>Page</code> object. This can be a useful pattern because it avoids
the extra <code>StringPage</code> object.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>Pageable</code> object definition.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>Page</code> object definition.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><code>StringContent</code> object definition. See 2.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td><code>StringPage</code> object definition. See 2.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The processor does create a proper interface with both endpoints if we provide a type mappings for
the <code>Pageable</code> and <code>Page</code> types.</p>
</div>
<div class="paragraph">
<p>Here is the java code we expect:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package generated.api;

import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;

public interface Api {

    @GetMapping(
            path = "/page",
            produces = {"application/json"})
    ResponseEntity&lt;Page&lt;String&gt;&gt; getPage(Pageable pageable);

    @GetMapping(
            path = "/page-inline",
            produces = {"application/json"})
    ResponseEntity&lt;Page&lt;String&gt;&gt; getPageInline(Pageable pageable);

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and here is the required mapping:</p>
</div>
<div class="paragraph">
<p>Using named objects in OpenAPI all we need is two global type mappings. The mappings below the
<code>page-inline</code> endpoint do the same for the inline variation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">map:

  types:
    - from: Pageable <i class="conum" data-value="1"></i><b>(1)</b>
      to: org.springframework.data.domain.Pageable

    - from: StringPage <i class="conum" data-value="2"></i><b>(2)</b>
      to: org.springframework.data.domain.Page&lt;java.lang.String&gt;

  paths:

    /page-inline: <i class="conum" data-value="3"></i><b>(3)</b>

      parameters:
        - name: pageable
          to: org.springframework.data.domain.Pageable

      responses:
        - content: application/json
          to: org.springframework.data.domain.Page&lt;java.lang.String&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>this maps the <code>Pageable</code> object defined in the OpenAPI to Springs <code>Pageable</code> type.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>this maps the <code>StringPage</code> object defined in the OpenAPI to Springs <code>Page</code> type including the
generic type of the page <code>content</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>mapping for the inline version.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Usually you would use the first variation using named objects, so they can be re-used on other
endpoints.</p>
</div>
<div class="paragraph">
<p>Worth mentioning is that the processor will not generate model classes for the openapi types
<code>Pageable</code>, <code>Page</code>, <code>StringContent</code> or <code>StringPage</code>.</p>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">

  <div class="footer-grid">

    <div class="main">

      <div class="footer-logo-title">
        <img src="../../../_/img/openapi-processor-p.svg" alt="logo" width="40px">
        <strong>openapi-processor</strong>
      </div>

      <div class="footer-license">
        <div><strong>License</strong></div>
        <div>
          openapi-processor packages spring, json & gradle are distributed by
          <a href="https://www.apache.org/licenses/LICENSE-2.0.txt"> Apache License 2.0</a>.
        </div>
      </div>

    </div>

    <div class="gh">
        <div class="footer-title">GitHub</div>

        <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-spring">
          <img src="../../../_/img/GitHub-Mark-32px.png" alt="GitHub"> openapi-processor-spring
        </a>

        <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-json">
          <img src="../../../_/img/GitHub-Mark-32px.png" alt="GitHub"> openapi-processor-json
        </a>

        <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-gradle">
          <img src="../../../_/img/GitHub-Mark-32px.png" alt="GitHub"> openapi-processor-gradle
        </a>
    </div>

  </div>

</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
