<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Endpoint content types :: openapi-processor</title>
    <link rel="canonical" href="https://hauner.github.io/openapi-processor/spring/processor/endpoint-content.html">
    <meta name="generator" content="Antora 2.3.0-beta.2">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <img src="../../_/img/openapi-processor-p.svg" alt="logo" width="100px">
      <a class="navbar-item" href="https://hauner.github.io/openapi-processor">openapi-processor</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

            <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-spring">
              <img src="../../_/img/GitHub-Mark-32px.png" alt="GitHub"> spring
            </a>
            <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-json">
              <img src="../../_/img/GitHub-Mark-32px.png" alt="GitHub"> json
            </a>
            <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-gradle">
              <img src="../../_/img/GitHub-Mark-32px.png" alt="GitHub"> gradle
            </a>

      </div>

    </div>

  </nav>
</header>

<div class="body">
<div class="nav-container" data-component="spring" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">oap-spring</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">The Processor</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="endpoint-interface.html">Endpoint Grouping</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="endpoint-content.html">Endpoint Content Type</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="models.html">Models</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parameter.html">Parameter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="requestbody.html">Request Body</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="response.html">Responses</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="identifier.html">Identifier</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../mapping/index.html">Type Mapping</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/structure.html">Type Mapping Structure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/basic.html">Default Type Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/global.html">Global Type Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/parameter.html">Global Parameter Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/response.html">Global Response Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/result.html">Global Result Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/single.html">Global Single Result Mapping</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mapping/endpoint.html">Endpoint Mapping</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../gradle.html">Gradle Integration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../howto/index.html">HowTo</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Mapping</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howto/global-array-mapping.html">Global Array Mapping</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howto/pageable-page-mapping.html">Pageable &amp; Page Mapping</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">OpenAPI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howto/file_upload.html">File Upload</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howto/file_download.html">File Download</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../links.html">Links</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">oap-spring</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">oap-api</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../api/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">oap-gradle</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../gradle/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">oap-json</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../json/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">oap-spring</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">master</a>
        </li>
        <li class="version">
          <a href="../1.0.0.M14/index.html">1.0.0.M14</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">oap-spring-mvc-sample</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../spring-mvc-sample/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">oap-spring-webflux-sample</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../spring-webflux-sample/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../1.0.0.M14/index.html" class="home-link"></a>
  <div class="edit-this-page"><a href="https://github.com/hauner/openapi-processor-spring/edit/master/docs/modules/ROOT/pages/processor/endpoint-content.adoc">edit</a></div>
    <div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">master</button>
  <div class="version-menu">
    <a class="version is-current" href="endpoint-content.html">master</a>
    <a class="version" href="../1.0.0.M14/processor/endpoint-content.html">1.0.0.M14</a>
  </div>
</div>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">oap-spring</a></li>
    <li><a href="index.html">The Processor</a></li>
    <li><a href="endpoint-content.html">Endpoint Content Type</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Endpoint content types</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A simple path of the OpenAPI description will usually produce a single endpoint method in the target
interface as described in the introduction.</p>
</div>
<div class="paragraph">
<p>OpenAPI allows us to define more complex apis that behave differently based on the request header.
For example the following api definition can return its response in different formats. As json or as
plain text:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">openapi: 3.0.2
info:
  title: multiple response content types
  version: 1.0.0

paths:
  /foo:
    get:
      responses:
        '200':
          description: json or plain text result
          content:
            application/json:
                schema:
                  $ref: '#/components/schemas/Foo'
            text/plain:
                schema:
                  type: string
        default:
          description: error
          content:
            application/xml:
                schema:
                  $ref: '#/components/schemas/Error'

components:

  schemas:
    Foo:
      type: object
      properties:
        bar:
          type: string

    Error:
      type: object
      properties:
        error:
          type: string</code></pre>
</div>
</div>
<div class="paragraph">
<p>A client request uses the request <code>Accept</code> header to tell the api which result content types it can
handle.</p>
</div>
<div class="paragraph">
<p>Using a single endpoint method it has to decide which response to create. This leads to some boring
<code>if/else</code> code. To avoid this the processor creates one endpoint method for each possible response.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_multiple_content_types"><a class="anchor" href="#_multiple_content_types"></a>multiple content types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For the example above (ignoring the <code>default</code> xml response) it creates the following interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package generated.api;

import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;

public interface Api {

    @GetMapping(
            path = "/foo",
            produces = {"application/json"})
    Foo getFooApplicationJson();

    @GetMapping(
            path = "/foo",
            produces = {"text/plain"})
    String getFooTextPlain();

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The apis normal response (status '200') can return the result as json or as plain text which leads
to two methods for the same endpoint but with a different <code>produces</code> list in the mapping annotation.</p>
</div>
<div class="paragraph">
<p>One method when json gets requested and one when plain text gets requested. Spring will take care of
selecting the correct endpoint.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_multiple_content_types_default_content_type"><a class="anchor" href="#_multiple_content_types_default_content_type"></a>multiple content types &amp; default content type</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the (contrived) example our api does also define another content type for all other result status
codes (usually the errors): xml. This results in the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package generated.api;

import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;

public interface Api {

    @GetMapping(
            path = "/foo",
            produces = {"application/json", "application/xml"})
    Object getFooApplicationJson();

    @GetMapping(
            path = "/foo",
            produces = {"text/plain", "application/xml"})
    Object getFooTextPlain();

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both endpoints need to handle the success case (json or text), and the error (xml) case. So both
mappings contain the xml content type. To handle the multiple responses the return type is now
<code>Object</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_multiple_content_types_default_content_type_result_wrapper"><a class="anchor" href="#_multiple_content_types_default_content_type_result_wrapper"></a>multiple content types, default content type &amp; result wrapper</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In case we (globally) enable a result wrapper, e.g. <code>ResponseEntity</code> in the <code>mapping.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">map:
  result:
    to: org.springframework.http.ResponseEntity</code></pre>
</div>
</div>
<div class="paragraph">
<p>the created code will now look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package generated.api;

import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;

public interface Api {

    @GetMapping(
            path = "/foo",
            produces = {"application/json", "application/xml"})
    ResponseEntity&lt;?&gt; getFooApplicationJson();

    @GetMapping(
            path = "/foo",
            produces = {"text/plain", "application/xml"})
    ResponseEntity&lt;?&gt; getFooTextPlain();

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response wraps the type by a <code>ResponseEntity</code> and to handle the multiple response types the
generic parameter is the <strong>unknown</strong> type.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">

  <div class="footer-grid">

    <div class="main">

      <div class="footer-logo-title">
        <img src="../../_/img/openapi-processor-p.svg" alt="logo" width="40px">
        <strong>openapi-processor</strong>
      </div>

      <div class="footer-license">
        <div><strong>License</strong></div>
        <div>
          openapi-processor packages spring, json & gradle are distributed by
          <a href="https://www.apache.org/licenses/LICENSE-2.0.txt"> Apache License 2.0</a>.
        </div>
      </div>

    </div>

    <div class="gh">
        <div class="footer-title">GitHub</div>

        <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-spring">
          <img src="../../_/img/GitHub-Mark-32px.png" alt="GitHub"> openapi-processor-spring
        </a>

        <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-json">
          <img src="../../_/img/GitHub-Mark-32px.png" alt="GitHub"> openapi-processor-json
        </a>

        <a class="navbar-link-icon" href="https://github.com/hauner/openapi-processor-gradle">
          <img src="../../_/img/GitHub-Mark-32px.png" alt="GitHub"> openapi-processor-gradle
        </a>
    </div>

  </div>

</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
